"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.TuyaIRDiscovery=void 0;const events_1=__importDefault(require("events")),TuyaIRConfiguration_1=require("./model/TuyaIRConfiguration"),LoginHelper_1=require("./api/LoginHelper"),DeviceConfigurationHelper_1=require("./api/DeviceConfigurationHelper");class TuyaIRDiscovery extends events_1.default{constructor(e,i){super(),this.log=e,this.platformConfig=i}startDiscovery(e,i){this.log.info(`Trying to login for index ${e}...`);const o=new TuyaIRConfiguration_1.TuyaIRConfiguration(this.platformConfig,e),t=LoginHelper_1.LoginHelper.Instance(o,this.log),r=DeviceConfigurationHelper_1.DeviceConfigurationHelper.Instance(o,this.log);t.login().then((()=>(this.log.info("Fetching configured remotes..."),r.fetchDevices(o.irDeviceId)))).then((o=>{i(o,e)})).catch((e=>{this.log.error("Failed because of "+e)}))}}exports.TuyaIRDiscovery=TuyaIRDiscovery;